    % This is samplepaper.tex, a sample chapter demonstrating the
% LLNCS macro package for Springer Computer Science proceedings;
% Version 2.20 of 2017/10/04
%
\documentclass[runningheads]{llncs}
%
\usepackage{graphicx}
\usepackage{hyperref}
\usepackage{amsthm}
% Used for displaying a sample figure. If possible, figure files should
% be included in EPS format.
%
% If you use the hyperref package, please uncomment the following line
% to display URLs in blue roman font according to Springer's eBook style:
% \renewcommand\UrlFont{\color{blue}\rmfamily}

\begin{document}
\newtheorem{defi}[theorem]{Definition}
%
\title{Property Graph Exchange Format}
%
%\titlerunning{Abbreviated paper title}
% If the paper title is too long for the running head, you can set
% an abbreviated paper title here
%
\author{Hirokazu Chiba\inst{1} \and Ryota Yamanaka\inst{2} \and Shota Matsumoto\inst{3}}
%
\authorrunning{H. Chiba et al.}
% First names are abbreviated in the running head.
% If there are more than two authors, 'et al.' is used.
%
\institute{
Database Center for Life Science, Chiba 277-0871, Japan\\
\email{chiba@dbcls.rois.ac.jp}
\and
Oracle Corporation, Bangkok 10500, Thailand\\
\email{ryota.yamanaka@oracle.com}
\and
Lifematics Inc., Tokyo 101-0041, Japan\\
\email{shota.matsumoto@lifematics.co.jp}
}
%
\maketitle              % typeset the header of the contribution
%
\begin{abstract}
%Property graph is an intuitive data structure for expressing information as network graphs.
%Although a variety of graph databases are designed for managing data as property graph, the definitions of this data structure and its data formats are various and often depend on the implementation. 
Recently, a variety of graph database implementations dedicated to analyses on the property graph model have emerged.
However, the data structure of the property graph model is not standardized and depends on each implementation.
%Therefore, in this paper, we discussed general definition of property graph based on the observation of the existing graph databases, and proposed a practical data format which can store the most information included in other data formats. 
Here, we generalize the definition of the property graph model to cover various database implementations and propose serializations of property graph data. 
This data format is independent from graph database implementation and interoperable to provide a interoperable way to echange property graph data. The format is not only general and but also in an intuitive form, thus it is useful when we generate and maintain property graph data. To show the usefulness of this general model and format, We implemented prototype tools to convert from this format into specific formats of various graph database implementations. This format can provide an interoperable platform for generating, sharing and utilizing property graph data.
\keywords{Property Graph \and Graph Database}
\end{abstract}

\section{Introduction}
Increasing amounts of scientific and social data are described and analyzed in the form of graphs.
As a format of graph data to be publicly available, the Resource Description Framework (RDF) is widely used. 
In the context of graph analysis, the property graph model~\cite{angles} is becoming popular; various graph database engines, including Neo4j~\cite{neo4j}, Oracle Labs PGX~\cite{pgx}, and Amazon Neptune~\cite{neptune}, adopt this model. These graph database engines support algorithms for traversal or analyzing graphs. 
%However, currently not many datasets are consistently described in the property graph model, so the application of these powerful engines are limited.
%Recently, a variety of graph database implementations dedicated to analyses on the property graph model have emerged. 
%However, the property graph lacks standardized specifications and the RDF model and the property graph model are not interoperable.
In contrast to the standardized RDF, however, there are no standardized data models for property graphs.
Here, we surveyed the general requirements for representing property graph data and designed a common property graph format, which can be converted to each of the specific database implementations mentioned above. A common format independent of different database implementations will increase the interoperability of graph databases, and will make it easier for users to import accumulated graph data making the most of graph database engines.


\section{Model Definition}
Here we define the property graph model that the proposed serialization handles.
We aim at serialization of wide range of property graphs such as graphs with arbitrary number of properties and labels. It also can be a mixed graph, which includes both directed and undirected edges. The property graph model has the following characteristics:

\begin{itemize}
    \item It contains nodes and edges.
    \item Each of nodes and edges can contain properties (key-value pairs).
    \item Each property can have multiple values.
    \item Each node or edge can be labeled with zero or more labels.
    \item Edges can be directed or undirected.
\end{itemize}
We describe the definition of the model as follows.

\begin{defi}[Property Graph]
\leavevmode \\
A \emph{Property Graph} is a tuple
$PG = \langle N, E_u, E_d, S, V, P, e, l_v, l_e, p_v, p_e\rangle$, where:
\begin{enumerate}
    \item $N$ is a set of nodes.
    \item $E_u$ is a set of undirected edges.
    \item $E_d$ is a set of directed edges.
    \item $E$ is a set of edges where $E = E_d \cup E_u$.
    \item $S$ is a set of strings.
    \item $V$ is a set of values of arbitrary data types.
    \item $P$ is a set of properties. Each property has a form $p = \langle k,v \rangle$, where $k \in S$ and $v \in 2^V$.
    \item $e: E \to \langle N \times N \rangle$ is a function which yields the endpoints of each directed or undirected edge (if the edge is directed, the first node is a source and the second node is a destination).
    \item $l_v : N \to 2^S$ is a function mapping each nodes to their multiple labels.
    \item $l_e : E \to 2^S$ is a function mapping each edge to their multiple labels.
    \item $p_v : N \to 2^P$ is a function used to assign nodes to their multiple properties.
    \item $p_e : E \to 2^P$ is a function used to assign edges to their multiple properties.
\end{enumerate}
\end{defi}

\section{Serialization}
According to the definition of property graph above, we propose data formats both in flat text and in JSON. While the flat text format (PG) is visually easier to understand as well as enable to be split or concatenate horizontally, the JSON format (JSON-PG) is useful in server-client communication.

Figure~\ref{fig:example-pg} shows an example of the flat text PG format.

\begin{itemize}
    \item Each line describes one node or one edge.
    \item All elements in each line are separated by space or tab.
    \item In nodes, the first column contains node ID.
    \item In edges, the first three columns contain source node ID, direction, and destination node ID
    \item Each line can contain arbitrarily many labels.
    \item Each line can contain arbitrarily many properties (= key-value pairs).
\end{itemize}

\begin{defi}[PG Format]
\leavevmode \\
\emph{PG format is described in the following EBNF notation.}
\begin{scriptsize}
\begin{verbatim}
    PG         ::= (Node | Edge)+
    Node       ::= ID Labels Properties NEWLINE
    Edge       ::= ID Direction ID Labels Properties NEWLINE
    Labels     ::= Label*
    Properties ::= Properties*
    Label      ::= ':' STRING
    Property   ::= STRING ':' Value
    Value      ::= STRING | NUMBER
    Direction  ::= '--' | '->'
\end{verbatim}
\end{scriptsize}
\label{fig:ebnf}
\end{defi}

Figure~\ref{fig:format-json} shows an example of the JSON-PG format. This format basically follows the rules of the general JSON format and the definition of property graph above. However, labels and property values are described as arrays, while they are substantially lists with no order in the elements.  

\begin{itemize}
    \item Nodes and edges are listed under \texttt{nodes} and \texttt{edges} elements, respectively.
    \item Edge direction is defined with the boolean element \texttt{undirected}. By default it is false (= directed).
    \item Labels are listed under the \texttt{labels} element.
    \item Properties (= key-value pairs) are listed under the \texttt{properties} element.
\end{itemize}

We have implemented a command-line tool to convert data between PG and JSON-PG, as well as to transform them to the data loading formats for the main graph databases such as Neo4j, Oracle Labs PGX, and Amazon Neptune. The actual use cases of this tool show that the proposed data format has the capability to describe general property graph data which are used in existing graph databases. (https://github.com/g2gml/pg)

\section{Conclusion}
In this work, we defined a property graph format independent of specific graph database implementations and proposed practical data formats. We also implemented a prototype of tools to convert this data format to other formats. 
It will increase the interoperability of graph databases and make it easier for users to import accumulated graph data, making the most of graph database engines.

\begin{figure}[!t]
\vspace{2mm}
\begin{scriptsize}
\begin{verbatim}
# NODES
101  :person  name:Alice  age:15  country:"United States"
102  :person  :Student  name:Bob  country:Japan  country:Germany

# EDGES
101 -- 102  :sameSchool  :sameClass  since:2012
102 -> 101  :likes  since:2015
\end{verbatim}
\end{scriptsize}
\caption{Example of PG}
\label{fig:example-pg}
\end{figure}

\begin{figure}[!t]
\vspace{2mm}
\begin{scriptsize}
\begin{verbatim}
{
  "nodes":[
    {"id":101, "labels":["Person"], "properties":{"name":["Alice"], "age":[15], "country":["United States"]}},
    {"id":102, "labels":["Person", "Student"], "properties":{"name":["Bob"], "country":["Japan", "Germany"]}}
  ],
  "edges":[
    {"from":101, "to":102, "undirected":true, "labels":["sameSchool", "sameClass"], "properties":{"since":[2012]}},
    {"from":102, "to":101, "labels":["likes"], "properties":{"since":[2015]}}
  ]
}
\end{verbatim}
\end{scriptsize}
\caption{Example of JSON-PG}
\label{fig:format-json}
\end{figure}


%Future works include ..

%
% ---- Bibliography ----
%
% BibTeX users should specify bibliography style 'splncs04'.
% References will then be sorted and formatted in the correct style.
%
% \bibliographystyle{splncs04}
% \bibliography{mybibliography}
%
\begin{thebibliography}{8}

\bibitem{angles}
Angles, R., Arenas, M., Barcel√≥, P., Hogan, A., Reutter, J., Vrgoc, D.: Foundations of Modern Query Languages for Graph Databases. ACM Computing Surveys (CSUR), 50(5), 68 (2017)

\bibitem{neo4j}
The Neo4j Graph Platform, \url{https://neo4j.com/}.

\bibitem{pgx}
Oracle Labs Parallel Graph AnalytiX (PGX), \url{https://www.oracle.com/technetwork/oracle-labs/parallel-graph-analytix/overview/index.html}.

\bibitem{neptune}
Amazon Neptune, \url{https://aws.amazon.com/neptune/}.

\bibitem{hartig}
Hartig, O.: Reconciliation of RDF* and property graphs. arXiv preprint arXiv:1409.3288 (2014)

\end{thebibliography}
\end{document}
